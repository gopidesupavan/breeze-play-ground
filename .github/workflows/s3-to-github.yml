name: Sync S3 to GitHub
on: # yamllint disable-line rule:truthy
  workflow_dispatch:
jobs:
  s3-to-github:
    name: S3 to GitHub
    runs-on: ubuntu-latest
    steps:
      - name: Install AWS CLI v2
        run: |
          curl "https://awscli.amazonaws.com/awscli-exe-linux-x86_64.zip" -o /tmp/awscliv2.zip
          unzip -q /tmp/awscliv2.zip -d /tmp
          rm /tmp/awscliv2.zip
          sudo /tmp/aws/install --update
          rm -rf /tmp/aws/

      - name: Configure AWS credentials
        uses: aws-actions/configure-aws-credentials@010d0da01d0b5a38af31e9c3470dbfdabdecca3a  # v4.0.1
        with:
          aws-access-key-id: "fake-key"
          aws-secret-access-key: "fake-secret"
          aws-region: us-east-2

      - name: Syncing
        run: |
          sudo mkdir -p /mnt/docs-archive && sudo chown -R "${USER}" /mnt/docs-archive
          aws s3 sync s3://staging-docs-airflow-apache-org/docs/ /mnt/docs-archive
          ls -la /mnt/docs-archive